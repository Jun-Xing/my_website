---
categories:
- ""
- ""
date: "2020-9-16"
description: Gender discrimination
draft: false
image: genderpay.jpg
keywords: ""
slug: gendercase
title: A Case Study on Gender Discrimination
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}
library(tidyverse)  
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
```

## Loading the data


```{r load_omega_data}
omega <- read_csv(here::here("data", "gender.csv"))
glimpse(omega) # examine the data frame
```

## Relationship Salary - Gender ?

```{r, confint_single_valiables}
# Summary Statistics of salary by gender
mosaic::favstats (salary ~ gender, data=omega)

# Dataframe with two rows (male-female) and having as columns gender, mean, SD, sample size, 
# the t-critical value, the standard error, the margin of error, 
# and the low/high endpoints of a 95% condifence interval
salary_sum_stats <- omega %>%
  group_by(gender) %>%
  summarise(mean_salary = mean(salary),
            sd_salary = sd(salary),
            count = n(),
            se_salary = sd_salary / sqrt(count),
            t_critical = qt(0.975, count - 1),
            margin_of_error = t_critical * se_salary,
            salary_low = mean_salary - margin_of_error,
            salary_high = mean_salary + margin_of_error)

salary_sum_stats
```

> What can you conclude from your analysis? A couple of sentences would be enough

Answer:
In this sample size, male's average salary is higher than the female's. Male's 95% confidence interval is also higher than the female's with no overlaps. If we take another sample, we are quite confident that the male's average salary would be higher than the female's in that sample too.

```{r, hypothesis_testing1}
# hypothesis testing using t.test() 
t.test(salary ~ gender, data = omega)

# hypothesis testing using infer package
salary_diff <- omega %>%
  infer::specify(salary ~ gender) %>%
  infer::calculate(stat = "diff in means", order = c("male", "female"))

salary_gender_null <- omega %>%
  infer::specify(salary ~ gender) %>%
  infer::hypothesize(null = "independence") %>%
  infer::generate(reps = 1000, type = "permute") %>%
  infer::calculate(stat = "diff in means", order = c("male", "female"))

salary_gender_null %>% visualize() +
  infer::shade_p_value(obs_stat = salary_diff, direction = "two-sided")

salary_gender_null %>%
  infer::get_p_value(obs_stat = salary_diff, direction = "two_sided")
```

> What can you conclude from your analysis? A couple of sentences would be enough

Answer: 
We can refuse the null hypothesis. The mean salaries of male and female are significantly different.

## Relationship Experience - Gender?


```{r, experience_stats}
# Summary Statistics of salary by gender
favstats (experience ~ gender, data=omega)

```

Based on this evidence, can you conclude that there is a significant difference between the experience of the male and female executives? Perform similar analyses as in the previous section. Does your conclusion validate or endanger your conclusion about the difference in male and female salaries?  

```{r, hypothesis_testing}
# hypothesis testing using t.test() 
t.test(experience ~ gender, data = omega)

# hypothesis testing using infer package
experience_diff <- omega %>%
  specify(experience ~ gender) %>%
  calculate(stat = "diff in means", order = c("male", "female"))

experience_gender_null <- omega %>%
  specify(experience ~ gender) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("male", "female"))

experience_gender_null %>% visualize() +
  shade_p_value(obs_stat = experience_diff, direction = "two-sided")

experience_gender_null %>%
  get_p_value(obs_stat = experience_diff, direction = "two_sided")
```

Answer:
There is a significant difference between the average experience of the male and female executives. But it does not prove the correlation between salary and experience, so it can neither validate nor endanger the previous conclusion.

## Relationship Salary - Experience ?

```{r, salary_exp_scatter}
ggplot(omega, aes(experience, salary)) +
  geom_point() +
  geom_smooth() +
  labs(
    title = "The Relationship between Salary and Experience",
    x = "Experience",
    y = "Salary"
  )
```

## Check correlations between the data

```{r, ggpairs}
omega %>% 
  select(gender, experience, salary) %>% #order variables they will appear in ggpairs()
  ggpairs(aes(colour=gender, alpha = 0.3))+
  theme_bw()
```

> Look at the salary vs experience scatterplot. What can you infer from this plot? Explain in a couple of sentences

Answer:
Salary and experience do have strong correlation and the correlation is higher within female. 
